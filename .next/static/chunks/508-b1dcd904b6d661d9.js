"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[508],{1508:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ej});var a=n(5155),s=n(2960),r=n(2020),i=n(2115),l=n(5695),o=n(6766),d=n(2108),c=n(2110);let u="http://localhost:3000/api/todolist";async function h(){let{kw:e="",status:t="",order:n="asc",sortField:a="status",currentPage:s=1,pageSize:r=10}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=new URLSearchParams;e&&i.append("kw",e),t&&i.append("status",t),n&&i.append("order",n),a&&i.append("sortField",a),i.append("page",String(s)),i.append("limit",String(r));let l=await fetch("".concat(u,"/?").concat(i.toString()));if(!l.ok)throw Error("Failed to fetch");return l.json()}async function x(e){let{todo:t}=e;return(await fetch(u,{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({todo:t})})).json()}async function m(e){let{id:t}=e;return(await fetch("".concat(u,"/").concat(t),{method:"DELETE"})).json()}async function j(e){let{id:t,completed:n,todo:a}=e,s={};void 0!==n&&(s.completed=n),void 0!==a&&(s.todo=a);let r=fetch("".concat(u,"/").concat(t),{method:"PATCH",headers:{"Content-type":"application/json"},body:JSON.stringify(s)});return(await r).json()}async function g(e){let{idArray:t}=e;return(await fetch("".concat(u),{method:"DELETE",headers:{"Content-type":"application/json"},body:JSON.stringify(t)})).json()}function p(e){let{input:t,setInput:n,onAdd:s}=e;return(0,a.jsxs)("div",{className:"flex items-center gap-1 ml-3 h-20",children:[(0,a.jsxs)("form",{action:"",children:[(0,a.jsx)("label",{className:"font-sans mb-3",children:"Add todo"}),(0,a.jsx)("input",{className:"text-black rounded-lg border border-gray-500 focus:ring-2 focus:ring-indigo-500 px-4 py-2 w-75 outline-none transition mb-8 h-12",type:"text",value:t,onChange:e=>n(e.target.value),placeholder:"Enter New Todo"})]}),(0,a.jsx)("button",{className:"text-black px-4 py-2 rounded-lg font-semibold shadow-black hover:bg-amber-600 transition bg-amber-200 w-20 ml-3 mr-3 h-12 mb-2.5",onClick:s,children:"Add"})]})}function f(e){let{searchInput:t,setSearchInput:n,handleSearch:s}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"flex items-center gap-2 h-18",children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),s(e,t)},children:[(0,a.jsx)("label",{className:"ml-3 font-sans",children:"Search"}),(0,a.jsx)("input",{className:"text-black rounded-lg border border-gray-500 focus:ring-2 focus:ring-indigo-400 px-4 py-2 w-76 outline-none transition ml-3 mb-6.5 h-12",type:"text",value:t,onChange:e=>n(e.target.value),placeholder:"Enter Keyword"})]})})})}function v(e){let{completedCount:t,unCompletedCount:n}=e;return(0,a.jsxs)("div",{className:"text-black flex justify-center text-3xl font-bold gap-3",children:[(0,a.jsxs)("div",{children:["Total: ",t+n]})," | ",(0,a.jsx)("div",{children:(0,a.jsxs)("p",{className:"text-green-500",children:[" Done: ",t," "]})}),"| ",(0,a.jsx)("div",{children:(0,a.jsxs)("p",{className:"text-red-500",children:["Pending: ",n]})})]})}var b=n(7088),A=n(7348),S=n(3939),y=n(8444);function w(e){let{selectedOrder:t,searchParams:n,router:s}=e;return(0,a.jsx)("div",{className:"h-8",children:(0,a.jsxs)(b.A,{sx:{m:.5,minWidth:90},children:[(0,a.jsx)(A.A,{id:"demo-label",children:"Created Date"}),(0,a.jsxs)(y.A,{labelId:"demo-label",id:"demo",value:t,onChange:e=>{var t;let a=new URLSearchParams(n.toString());a.set("sortField","createdDate"),a.set("order",null!=(t=e.target.value)?t:""),a.set("page","1"),s.push("?".concat(a.toString()))},autoWidth:!0,label:"Created Date",children:[(0,a.jsx)(S.A,{value:"asc",children:"Asc"}),(0,a.jsx)(S.A,{value:"desc",children:"Desc"})]})]})})}function C(e){let{SelectedPageSize:t,onChangePageSize:n}=e;return(0,a.jsx)("div",{children:(0,a.jsxs)(b.A,{sx:{m:.5,minWidth:70},children:[(0,a.jsx)(A.A,{id:"demo label",children:"Page Size"}),(0,a.jsxs)(y.A,{labelId:"demo-label",id:"demo",value:t,onChange:e=>{n(Number(e.target.value))},autoWidth:!0,label:"Page Size",children:[(0,a.jsx)(S.A,{value:4,children:"4"}),(0,a.jsx)(S.A,{value:8,children:"8"}),(0,a.jsx)(S.A,{value:12,children:"12"})]})]})})}function N(e){let{selectStatus:t,searchParams:n,router:s}=e;return(0,a.jsx)("div",{children:(0,a.jsxs)(b.A,{sx:{m:.5,minWidth:90},children:[(0,a.jsx)(A.A,{id:"demo-label",children:"Status"}),(0,a.jsxs)(y.A,{labelId:"demo-label",id:"demo",value:t,onChange:e=>{var t;console.log(e.target.value);let a=new URLSearchParams(n.toString());a.set("status",null!=(t=e.target.value)?t:""),a.set("page","1"),s.push("?".concat(a.toString()))},autoWidth:!0,label:"Status",children:[(0,a.jsx)(S.A,{value:"",children:"All"}),(0,a.jsx)(S.A,{value:"true",children:"Done"}),(0,a.jsx)(S.A,{value:"false",children:"Pending"})]})]})})}var k=n(4507);function F(e){let{currentPage:t,total:n,pageSize:s,router:r,searchParams:i}=e,l=Math.ceil(n/s);return(0,a.jsx)("div",{className:"flex justify-center my-6",children:(0,a.jsx)(k.A,{count:l,page:t,onChange:(e,t)=>{let n=new URLSearchParams(i.toString());n.set("page",String(t)),r.push("?".concat(n.toString()))}})})}var D=n(6715),E=n(7422),P=n(1218),z=n(3613),I=n(6632),T=n(700),L=n(3734),O=n(6490),U=n(644),R=n(9505),M=n(8534),W=n(398);function Q(e){let{todo:t,idx:n,checked:s,editId:r,editTodo:i,setEditId:l,setEditTodo:o,onCheck:d,onDelete:u,onUpdate:h}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.A,{size:2.5,justifyContent:"space-between",children:(0,a.jsxs)(P.A,{sx:{width:350,backgroundColor:"#FEFFDF",border:1,boxShadow:10},children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("div",{children:(0,a.jsx)(z.A,{size:"small",color:"success",checked:!!s,onChange:()=>d(n)})}),(0,a.jsx)("div",{}),(0,a.jsx)("div",{className:"text-2xl mr-2",children:t.createdDate?new Date(t.createdDate).toLocaleDateString("vi-VN"):""})]}),(0,a.jsxs)(I.A,{children:[(0,a.jsx)(T.A,{align:"center",variant:"h5",children:r===t.id?(0,a.jsx)("input",{value:i,onChange:e=>o(e.target.value),type:"text",onKeyDown:e=>{"Enter"===e.key&&h({id:t.id,todo:i})}}):(0,a.jsxs)("div",{children:[t.todo,(0,a.jsx)("button",{className:"ml-1",onClick:()=>{l(t.id),o(t.todo)},children:(0,a.jsx)(U.A,{color:"action"})})]})}),(0,a.jsx)(T.A,{variant:"h6",align:"center",children:t.completed?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(L.SE8,{className:"text-green-600 inline"})," Done"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(L.X,{className:"text-red-600 inline"})," Pending"]})}),(0,a.jsx)(T.A,{})]}),(0,a.jsxs)(O.A,{sx:{backgroundColor:"#fafafa",justifyContent:"space-around"},children:[(0,a.jsxs)(M.A,{disabled:t.completed,onClick:()=>{h({id:t.id,completed:!t.completed})},color:"secondary",children:[(0,a.jsx)(W.A,{}),"Mark Done"]}),(0,a.jsxs)(M.A,{color:"error",onClick:()=>u({id:t.id}),children:[(0,a.jsx)(R.A,{}),"Delete"]})]})]})},t.id),";"]})}var X=n(6564);function _(e){let{selectedId:t,onCount:n,onDelete:s}=e;return(0,a.jsx)(X.A,{children:(0,a.jsx)(M.A,{variant:"outlined",color:"secondary",startIcon:(0,a.jsx)(X.A,{badgeContent:n,color:"error",children:(0,a.jsx)(R.A,{})}),onClick:()=>{s({idArray:t})},className:"flex justify-items-end",disabled:0===t.length,children:"Delete Selected Todo"})})}var B=n(1169),H=n(4581),J=n(529),K=n(3127),q=n(4389),G=n(4289);let V=e=>(0,a.jsx)(H.A,{sx:{flexGrow:1},children:(0,a.jsx)(B.A,{children:(0,a.jsxs)(J.A,{children:[(0,a.jsx)(K.A,{size:"large",edge:"start","aria-label":"menu",sx:{mr:2},onClick:e.handleMenu,children:e.open?(0,a.jsx)(q.A,{}):(0,a.jsx)(G.A,{})}),(0,a.jsx)(T.A,{variant:"h6",sx:{flexGrow:1},children:"DashBoard"})]})})});var Y=n(5528),Z=n(2376),$=n(3148),ee=n(9489),et=n(9125),en=n(5808);function ea(){return(0,a.jsx)("button",{className:"text-black hover:scale-150 text-3xl",onClick:()=>(0,d.signOut)({redirect:!1,callbackUrl:"/"}),children:(0,a.jsx)(en.A,{fontSize:"large"})})}var es=n(5222);function er(e){let{open:t}=e;return(0,a.jsx)($.A,{children:["Home","Sign Out"].map((e,n)=>(0,a.jsx)(Y.Ay,{disablePadding:!0,children:(0,a.jsxs)(Z.A,{sx:[{minHeight:8},t?{justifyContent:"initial"}:{justifyContent:"center"}],children:[(0,a.jsx)(ee.A,{children:n%2==0?(0,a.jsx)(et.A,{}):(0,a.jsx)(ea,{})}),(0,a.jsx)(es.A,{primary:e,sx:[t?{opacity:1}:{opacity:0}],onClick:()=>(0,d.signOut)({redirect:!0,callbackUrl:"/"})})]})},e))})}var ei=n(5955),el=n(2939);let eo={position:"fixed",top:"7dvh",backgroundColor:"rgb(255 255 255 / 95%)"},ed={position:"relative",top:0,backgroundColor:"#FEFFDF"},ec=e=>({width:240,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen}),overflowX:"hidden",...eo,[e.breakpoints.up("lg")]:{...ed}}),eu=e=>({transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),overflowX:"hidden",width:"calc(".concat(e.spacing(7)," + 1px)"),...eo,[e.breakpoints.up("sm")]:{width:"calc(".concat(e.spacing(8)," + 1px)")},[e.breakpoints.up("lg")]:{...ed}}),eh=(0,ei.Ay)(el.Ay,{shouldForwardProp:e=>"open"!==e})(e=>{let{theme:t}=e;return{width:240,flexShrink:0,whiteSpace:"nowrap",boxSizing:"border-box",...eo,zIndex:1,variants:[{props:e=>{let{open:t}=e;return t},style:{...ec(t),"& .MuiDrawer-paper":ec(t)}},{props:e=>{let{open:t}=e;return!t},style:{...eu(t),"& .MuiDrawer-paper":eu(t)}}]}});var ex=n(2548);function em(e){let{open:t}=e;return(0,a.jsxs)(H.A,{display:"flex",position:"relative",sx:{mt:8},color:"Background",children:[(0,a.jsx)(ex.Ay,{}),(0,a.jsx)(eh,{variant:"permanent",open:t,color:"primary",children:(0,a.jsx)(er,{open:!0})})]})}function ej(){let{data:e,status:t}=(0,d.useSession)(),n=(0,l.useRouter)(),u=(0,l.useSearchParams)();console.log(e),(0,i.useEffect)(()=>{"unauthenticated"===t&&n.push("/")},[t,n]);let[b,A]=(0,i.useState)(8),S=u.get("kw")||"",y=u.get("status")||"",k=Number(u.get("page"))||1,P=u.get("order")||"asc",z=u.get("sortField")||"status",I=Number(u.get("limit"))||b,[T,L]=(0,i.useState)(S),[O,U]=(0,i.useState)(""),[R,M]=(0,i.useState)(null),[W,X]=(0,i.useState)(""),[B,H]=(0,i.useState)([]),[J,K]=(0,i.useState)([]),[q,G]=(0,i.useState)(!1),Y=e=>{let t=B.map((t,n)=>n===e?!t:t);H(t);let n=et[e].id,a=[...J];t[e]?a.push(n):a=a.filter(e=>e!==n),K(a)},{data:Z,isLoading:$}=(0,s.I)({queryKey:["todos",S,y,P,z,k,I],queryFn:async()=>await h({kw:S,status:y,order:P,sortField:z,currentPage:k,pageSize:I}),staleTime:3e4,gcTime:3e5,placeholderData:r.rX}),ee=["todos",S,y,P,z,k,I],et=Array.isArray(null==Z?void 0:Z.todos)?Z.todos.map(e=>({...e,createdDate:e.createdDate})):[],en=function(e){let t=(0,D.jE)();return(0,E.n)({mutationFn:x,onSuccess:()=>{t.invalidateQueries({queryKey:e})}})}(ee),ea=function(e){let t=(0,D.jE)();return(0,E.n)({mutationFn:m,onSuccess:()=>{t.invalidateQueries({queryKey:e})}})}(ee),es=function(e,t,n){let a=(0,D.jE)();return(0,E.n)({mutationFn:j,onSuccess:()=>{a.invalidateQueries({queryKey:e}),t(null),n("")}})}(ee,M,X),er=function(e,t,n,a){let s=(0,D.jE)();return(0,E.n)({mutationFn:g,onSuccess:()=>{s.invalidateQueries({queryKey:e}),t(Array(a).fill(!1)),n([])}})}(ee,H,K,et.length);return(0,i.useEffect)(()=>{H(Array(et.length).fill(!1)),K([])},[et.length]),(0,a.jsxs)("div",{className:"text-2x1 text-white bg-gradient-to-r from-amber-100 to-amber-300 h-full grid-cols-subgrid border-2 min-h-screen flex",children:[(0,a.jsx)(V,{handleMenu:()=>{G(!q)},open:q}),(0,a.jsx)(em,{open:q}),(0,a.jsxs)("div",{className:"mt-13",children:[(0,a.jsxs)("div",{className:"basis-128 text-center mb-4 text-5xl bg-gradient-to-r from-amber-100 to-amber-300 text-[#050505] font-extrabold flex justify-center mt-5",children:[(0,a.jsx)(o.default,{src:"/todo.svg",alt:"todo",width:40,height:40}),(0,a.jsx)("p",{className:"ml-2",children:"YourTODO"})]}),(0,a.jsxs)("div",{className:"flex justify-items-center-safe ml-100 gap-4 mb-6 p-4 shadow w-280 text-black h-25 rounded-xl bg-[#eff1a0]",children:[(0,a.jsx)("div",{className:"w-100 bg-[#FEFFDF] flex-1/3 rounded-xl",children:(0,a.jsx)(p,{input:O,setInput:U,onAdd:()=>{O.trim()&&(en.mutate({todo:O}),U(""))}})}),(0,a.jsx)("div",{className:"flex-1/3 bg-[#FEFFDF] rounded-xl flex justify-center",children:(0,a.jsx)(f,{searchInput:T,setSearchInput:L,handleSearch:(e,t)=>{e.preventDefault();let a=new URLSearchParams(u.toString());a.set("kw",t),a.set("page","1"),n.push("?".concat(a.toString())),L("")}})}),(0,a.jsx)("div",{className:"flex flex-1/3 justify-center bg-[#FEFFDF] rounded-xl",children:(0,a.jsxs)("div",{className:"flex flex-row mt-0.5",children:[(0,a.jsx)(N,{selectStatus:y,searchParams:u,router:n}),(0,a.jsx)(w,{selectedOrder:P,searchParams:u,router:n}),(0,a.jsx)(C,{SelectedPageSize:b,onChangePageSize:e=>{let t=new URLSearchParams(u.toString());t.set("limit",String(e)),t.set("page","1"),n.push("?".concat(t.toString())),A(e)}})]})})]}),(0,a.jsx)("div",{children:Z&&(0,a.jsx)(v,{completedCount:Z.completedCount||0,unCompletedCount:Z.unCompletedCount||0})}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)("div",{children:(0,a.jsx)(_,{selectedId:J,onCount:B.filter(Boolean).length,onDelete:er.mutate})})}),$?(0,a.jsx)("div",{className:"text-center",children:"Loading..."}):0===et.length?(0,a.jsx)("div",{className:"text-center",children:"No result"}):(0,a.jsx)("div",{className:"ml-20 mt-10",children:(0,a.jsx)(c.A,{container:!0,spacing:4,sx:{justifyContent:"space-between"},columns:{xs:4,sm:8,md:12},children:et.map((e,t)=>(0,a.jsx)(Q,{todo:e,idx:t,checked:!!B[t],editId:R,editTodo:W,setEditId:M,setEditTodo:X,onCheck:Y,onUpdate:es.mutate,onDelete:ea.mutate},e.id))})}),Z&&(0,a.jsx)(F,{currentPage:k,total:Z.total,pageSize:I,router:n,searchParams:u})]})]})}}}]);