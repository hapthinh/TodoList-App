{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 156, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Toby/TodoList/TodoList-App/src/shareCode/common.ts"],"sourcesContent":["import { env } from \"process\";\r\n\r\nexport interface IBDSettings {\r\n  host: string;\r\n  port: number;\r\n  user: string;\r\n  password: string;\r\n  database: string;\r\n}\r\n\r\nexport const GetDBSettings = (): IBDSettings => {\r\n  const env = process.env.NODE_ENV;\r\n\r\n  if (env === \"development\")\r\n    return {\r\n      host: \"localhost\",\r\n      port: 3306,\r\n      user: \"root\",\r\n      password: \"Admin@123\",\r\n      database: \"todolist\",\r\n    };\r\n};\r\n"],"names":[],"mappings":";;;AAUO,MAAM,gBAAgB;IAC3B,MAAM;IAEN,wCACE,OAAO;QACL,MAAM;QACN,MAAM;QACN,MAAM;QACN,UAAU;QACV,UAAU;IACZ;AACJ","debugId":null}},
    {"offset": {"line": 175, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Toby/TodoList/TodoList-App/src/app/db/schema.ts"],"sourcesContent":["import { serial, text, boolean, pgTable } from \"drizzle-orm/pg-core\";\r\n\r\nexport const todos = pgTable(\"todo\", {\r\n  id: serial(\"id\").primaryKey(),\r\n  todo: text(\"todo\"),\r\n  completed: boolean(\"completed\").default(false),\r\n  createdDate: text(\"createdDate\"),\r\n});\r\n"],"names":[],"mappings":";;;AAAA;AAAA;AAAA;AAAA;;AAEO,MAAM,QAAQ,CAAA,GAAA,uJAAA,CAAA,UAAO,AAAD,EAAE,QAAQ;IACnC,IAAI,CAAA,GAAA,mKAAA,CAAA,SAAM,AAAD,EAAE,MAAM,UAAU;IAC3B,MAAM,CAAA,GAAA,iKAAA,CAAA,OAAI,AAAD,EAAE;IACX,WAAW,CAAA,GAAA,oKAAA,CAAA,UAAO,AAAD,EAAE,aAAa,OAAO,CAAC;IACxC,aAAa,CAAA,GAAA,iKAAA,CAAA,OAAI,AAAD,EAAE;AACpB","debugId":null}},
    {"offset": {"line": 205, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Toby/TodoList/TodoList-App/src/app/db/index.ts"],"sourcesContent":["import { drizzle } from \"drizzle-orm/node-postgres\";\r\nimport { Pool } from \"pg\";\r\n\r\nconst pool = new Pool({\r\n  connectionString:\r\n    process.env.DATABASE_URL ||\r\n    \"postgres://postgres:root@localhost:5432/todolist_db\",\r\n});\r\n\r\nexport const db = drizzle(pool);\r\n"],"names":[],"mappings":";;;AAAA;AACA;;;;;;;;AAEA,MAAM,OAAO,IAAI,oGAAA,CAAA,OAAI,CAAC;IACpB,kBACE,QAAQ,GAAG,CAAC,YAAY,IACxB;AACJ;AAEO,MAAM,KAAK,CAAA,GAAA,8JAAA,CAAA,UAAO,AAAD,EAAE","debugId":null}},
    {"offset": {"line": 228, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Toby/TodoList/TodoList-App/src/app/api/todolist/route.ts"],"sourcesContent":["import mysql from \"mysql2/promise\";\r\n\r\nimport { NextResponse } from \"next/server\";\r\n\r\nimport { GetDBSettings } from \"shareCode/common\";\r\n\r\nimport { todos } from \"app/db/schema\";\r\nimport { db } from \"app/db\";\r\nimport { ilike, eq, and, asc, desc } from \"drizzle-orm\";\r\n\r\nexport async function GET(request: Request) {\r\n  const { searchParams } = new URL(request.url);\r\n\r\n  const kw = searchParams.get(\"kw\") || \"\";\r\n  const status = searchParams.get(\"status\") || \"\";\r\n  const page = parseInt(searchParams.get(\"page\") || \"1\", 10);\r\n  const limit = parseInt(searchParams.get(\"limit\") || \"10\", 10);\r\n  const order = searchParams.get(\"order\") || \"\";\r\n  const sortField = searchParams.get(\"sortField\") || \"id\";\r\n\r\n  const whereClaus = [];\r\n\r\n  if(kw) whereClaus.push(ilike(todos.todo, `%${kw}%`))\r\n  if(status) whereClaus.push(eq(todos.completed, status === \"true\"))\r\n\r\n  const validSortField =  {\r\n    id: todos.id,\r\n    todo: todos.todo,\r\n    createdDate: todos.createdDate\r\n  }\r\n\r\n  const result = await db.select()\r\n                          .from(todos)\r\n                          .where(whereClaus.length ? and(...whereClaus) : undefined)\r\n                          .orderBy(order === \"asc\" ? asc(validSortField[sortField]) : desc(validSortField[sortField]))\r\n  \r\n  const total = result.length\r\n  const start = (page - 1)*limit;\r\n  const end = start + limit;\r\n  const pageTodos = result.slice(start, end)\r\n\r\n  return NextResponse.json({\r\n    todos: pageTodos,\r\n    total, \r\n    page,\r\n    limit\r\n  })\r\n\r\n}\r\n\r\nexport async function POST(request: Request) {\r\n  const body = await request.json();\r\n  console.log(body);\r\n\r\n  const result = await db.insert(todos).values({\r\n    todo: body.todo,\r\n    completed: false,\r\n    createdDate: new Date().toISOString()\r\n  }).returning()\r\n\r\n  return NextResponse.json(result[0])\r\n}\r\n\r\nexport async function DELETE(request: Request) {\r\n  const body = await request.json();\r\n  const id = body.id;\r\n  console.log(id);\r\n  try {\r\n    const connectionsParams = GetDBSettings();\r\n    const connection = await mysql.createConnection(connectionsParams);\r\n\r\n    const query = `DELETE FROM todolist.todo WHERE id=?`;\r\n    const values = [id];\r\n\r\n    const [result] = await connection.execute(query, values);\r\n\r\n    await connection.end();\r\n\r\n    return NextResponse.json(result);\r\n  } catch (err) {\r\n    console.log(\"ERROR: \", (err as Error).message);\r\n    const response = {\r\n      error: (err as Error).message,\r\n      returnStatus: 500,\r\n    };\r\n    return NextResponse.json({ response });\r\n  }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}